{
  "hash": "43b409d65f3b519ce29166009c4899d7",
  "result": {
    "markdown": "---\ntitle: \"`data-wrangling-i` - live-coding guide\"\nformat: html\n---\n\n\n## `data-wrangling-i` - live-coding guide\n\n1. Open RStudio in a new project\n2. Create a new R script or Quarto document\n3. Import `scdb_cases`\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-1_0ecdac589115c4c984056a7ee09b461d'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(scales)\n\nscdb_case <- read_csv(\"https://info3312.infosci.cornell.edu/slides/data/scdb-case.csv\")\n```\n:::\n\n\n4. Select relevant columns for viewing purposes\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-2_e27b8028923a324d7b2a221656d8c77d'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 29,021 × 3\n    term majVotes minVotes\n   <dbl>    <dbl>    <dbl>\n 1  1791        5        0\n 2  1791        5        0\n 3  1792        6        0\n 4  1792        6        0\n 5  1792        4        2\n 6  1792        6        0\n 7  1793        4        1\n 8  1793        5        0\n 9  1793        4        1\n10  1794        1        0\n# … with 29,011 more rows\n```\n:::\n:::\n\n\n5. Filter data\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-3_27b6d07b425c083ef834a4030841ff03'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9,299 × 3\n    term majVotes minVotes\n   <dbl>    <dbl>    <dbl>\n 1  1945        8        0\n 2  1945        7        1\n 3  1945        8        0\n 4  1945        8        0\n 5  1945        8        0\n 6  1945        7        1\n 7  1945        8        0\n 8  1945        8        0\n 9  1945        8        0\n10  1945        8        0\n# … with 9,289 more rows\n```\n:::\n:::\n\n\n6. Calculate vote margin variable\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-4_4909be769f3b34bc183473e1a165d60b'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9,299 × 4\n    term majVotes minVotes vote_margin\n   <dbl>    <dbl>    <dbl>       <dbl>\n 1  1945        8        0           8\n 2  1945        7        1           6\n 3  1945        8        0           8\n 4  1945        8        0           8\n 5  1945        8        0           8\n 6  1945        7        1           6\n 7  1945        8        0           8\n 8  1945        8        0           8\n 9  1945        8        0           8\n10  1945        8        0           8\n# … with 9,289 more rows\n```\n:::\n:::\n\n\n7. Calculate number of cases decided per term and vote margin\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-5_32852e91a6af34128f90ab2ec75cf100'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 686 × 3\n    term vote_margin     n\n   <dbl>       <dbl> <int>\n 1  1945           0     3\n 2  1945           1     9\n 3  1945           2    17\n 4  1945           3     8\n 5  1945           4    13\n 6  1945           5     6\n 7  1945           6    24\n 8  1945           7    16\n 9  1945           8    43\n10  1946           0     1\n# … with 676 more rows\n```\n:::\n:::\n\n\n8. Calculate percentages by term\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-6_88e4e8a1a97c9ae11cbbe0440766f043'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 686 × 4\n# Groups:   term [77]\n    term vote_margin     n   n_pct\n   <dbl>       <dbl> <int>   <dbl>\n 1  1945           0     3 0.0216 \n 2  1945           1     9 0.0647 \n 3  1945           2    17 0.122  \n 4  1945           3     8 0.0576 \n 5  1945           4    13 0.0935 \n 6  1945           5     6 0.0432 \n 7  1945           6    24 0.173  \n 8  1945           7    16 0.115  \n 9  1945           8    43 0.309  \n10  1946           0     1 0.00704\n# … with 676 more rows\n```\n:::\n:::\n\n\n9. Generate basic plot\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-7_fb7517d4a69cc52bf6e99c37383b5952'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area()\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n10. Need to convert `vote_margin` to factor\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-8_fcfc7160d18d689ec150795219b66ade'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area()\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n11. Why not adding up to 1? Check data frame for gaps. Need complete combinations of `term` and `vote_margin`\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-9_e40746efce02318cf972734880a51b5b'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 686 × 4\n# Groups:   term [77]\n    term vote_margin     n   n_pct\n   <dbl> <fct>       <int>   <dbl>\n 1  1945 0               3 0.0216 \n 2  1945 1               9 0.0647 \n 3  1945 2              17 0.122  \n 4  1945 3               8 0.0576 \n 5  1945 4              13 0.0935 \n 6  1945 5               6 0.0432 \n 7  1945 6              24 0.173  \n 8  1945 7              16 0.115  \n 9  1945 8              43 0.309  \n10  1946 0               1 0.00704\n# … with 676 more rows\n```\n:::\n:::\n\n\n12. Fill in missing combos with `tidyr::complete()`\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-10_a701c924a6e21c9e62a24da99ac36cc4'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # fill in all the missing combination of rows - plot won't look right otherwise\n  complete(term, vote_margin, fill = list(n = 0)) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area()\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n13. Add color to area borders. Label the y-axis\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-11_4512cd8787f64cc2f50031ccf0700d24'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # fill in all the missing combination of rows - plot won't look right otherwise\n  complete(term, vote_margin, fill = list(n = 0)) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area(color = \"cornsilk4\") +\n  # print the y-axis labels using percentages rather than proportions\n  scale_y_continuous(labels = label_percent())\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n14. Use appropriate color palette\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-12_7bbaf437c66015d1f5476bc4425b0bd7'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # fill in all the missing combination of rows - plot won't look right otherwise\n  complete(term, vote_margin, fill = list(n = 0)) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area(color = \"cornsilk4\") +\n  # print the y-axis labels using percentages rather than proportions\n  scale_y_continuous(labels = label_percent()) +\n  # change the color palette\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n15. Change order of stack using `fct_rev()`\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-13_f4ba75dcc802617945e8612fb07ddb86'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # fill in all the missing combination of rows - plot won't look right otherwise\n  complete(term, vote_margin, fill = list(n = 0)) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin),\n    vote_margin = fct_rev(f = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area(color = \"cornsilk4\") +\n  # print the y-axis labels using percentages rather than proportions\n  scale_y_continuous(labels = label_percent()) +\n  # change the color palette\n  scale_fill_viridis_d()\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n16. Label the plot and color the subtitle and caption\n\n\n::: {.cell layout-align=\"center\" hash='07-data-wrangling-i-notes_cache/html/unnamed-chunk-14_150ffacd349787f61393490484017d2d'}\n\n```{.r .cell-code}\nscdb_case |>\n  # select relevant columns\n  select(term, majVotes, minVotes) |>\n  # filter to include post 1945 term cases\n  filter(term >= 1945) |>\n  # calculate vote margin for each case\n  mutate(vote_margin = majVotes - minVotes) |>\n  # fill in all the missing combination of rows - plot won't look right otherwise\n  complete(term, vote_margin, fill = list(n = 0)) |>\n  # calculate number of cases decided per term and vote margin\n  count(term, vote_margin) |>\n  # calculate percentages by term\n  group_by(term) |>\n  mutate(\n    n_pct = n / sum(n),\n    # convert vote_margin to factor variable for plotting\n    vote_margin = factor(x = vote_margin),\n    vote_margin = fct_rev(f = vote_margin)\n  ) |>\n  # generate graph\n  ggplot(mapping = aes(x = term, y = n_pct, fill = vote_margin)) +\n  geom_area(color = \"cornsilk4\") +\n  # print the y-axis labels using percentages rather than proportions\n  scale_y_continuous(labels = label_percent()) +\n  # change the color palette\n  scale_fill_viridis_d() +\n  # label our graph\n  labs(\n    title = \"U.S. Supreme Court decisionmaking since 1945\",\n    subtitle = \"Split between majority and minority justice votes\",\n    x = \"Term\",\n    y = \"Percent of total cases decided\",\n    fill = \"Vote margin\",\n    caption = \"Source: The Supreme Court Database\"\n  ) +\n  # match subtitle and caption colors to area borders\n  theme(\n    plot.subtitle = element_text(color = \"cornsilk4\"),\n    plot.caption = element_text(color = \"cornsilk4\")\n  )\n```\n\n::: {.cell-output-display}\n![](07-data-wrangling-i-notes_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=80%}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}