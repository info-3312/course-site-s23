{
  "hash": "73c9c1e52defbd9a9818f024d6b530d3",
  "result": {
    "markdown": "---\ntitle: \"Deep dive: themes + axes + annotation\"\nsubtitle: \"Lecture 10\"\ndate: \"February 23, 2023\"\nformat: revealjs\n---\n\n\n\n\n# Announcements\n\n## Announcements\n\nTODO\n\n## Agenda for today\n\n- Themes\n- Axes\n- Annotations\n\n# Setup\n\n## Packages + figures\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(ggthemes)\nlibrary(ggpomological)\nlibrary(colorspace)\nlibrary(lubridate)\nlibrary(hrbrthemes)\nlibrary(WDI)\nlibrary(ggrepel)\nlibrary(ggtext)\n\n# setup custom fonts\nlibrary(showtext)\nfont_add_google(name = \"Roboto Condensed\")\n\n# set default theme for ggplot2\ntheme_set(theme_gray(base_size = 12))\n```\n:::\n\n\n## YAML options\n\n```yaml\nknitr:\n  opts_chunk:\n    fig.width: 7\n    fig.asp: 0.618\n    fig.retina: 2\n    dpi: 150\n    out.width: \"80%\"\n    fig.showtext: true\n```\n\n# Themes\n\n## Is that gray background okay?\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/standard-grey_c8774d46a9e59b3f0784ee92523d4342'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/standard-grey-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n. . .\n\nIt adds contrast! Some people just don't like it 🤷\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/alternatives_9ab78be9ef191ad658cf0062562501f5'}\n::: {.cell-output-display}\n![](https://i.imgur.com/9luIDwf.gif){fig-align='center' width=80%}\n:::\n:::\n\n\n## Like this!\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/hrbrlight_fcfefd02413f02813112f2819cc65a6c'}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\nlibrary(ggthemes)\n\nggplot(penguins, aes(\n  x = bill_depth_mm,\n  y = bill_length_mm,\n  color = species\n)) +\n  geom_point(size = 2) +\n  theme_tufte()\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/hrbrlight-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## And this!\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/hrbrdark_766d13a102f7dd783520c522debc8f3d'}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\nlibrary(ggthemes)\n\nggplot(penguins, aes(\n  x = bill_depth_mm,\n  y = bill_length_mm,\n  color = species\n)) +\n  geom_point(size = 2) +\n  theme_solarized()\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/hrbrdark-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Or this!\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/economist_55eaa5ef10b63f9074e112c0f3fa5064'}\n\n```{.r .cell-code  code-line-numbers=\"9-10\"}\nlibrary(ggthemes)\n\nggplot(penguins, aes(\n  x = bill_depth_mm,\n  y = bill_length_mm,\n  color = species\n)) +\n  geom_point(size = 2) +\n  scale_color_economist() +\n  theme_economist()\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/economist-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## And even this!\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pomological_c72e76991023ec8c230b7f52b4e913d2'}\n\n```{.r .cell-code  code-line-numbers=\"12-13\"}\nlibrary(ggpomological)\nlibrary(showtext)\n\nfont_add_google(\"Homemade Apple\")\n\nggplot(penguins, aes(\n  x = bill_depth_mm,\n  y = bill_length_mm,\n  color = species\n)) +\n  geom_point(size = 2) +\n  scale_color_pomological() +\n  theme_pomological_fancy()\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pomological-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n# One magic, powerful function\n\n. . .\n\n[`theme()`]{.hand}\n\n# The anatomy of a `ggplot()` theme\n\n## Theme system\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-9_c22c4260c2e206e07e02c4910b765f70'}\n::: {.cell-output-display}\n![](images/10/theme_elements-1024x755.png){fig-align='center' width=80%}\n:::\n:::\n\n\n::: footnote\nSource: [`ggplot2` theme elements demonstration](https://henrywang.nl/ggplot2-theme-elements-demonstration/)\n:::\n\n## Theme elements\n\n### Each element in the plot can be targeted\n\n::: incremental\n- Plot title = `plot.title`\n- Grid lines = `panel.grid`\n- Legend background = `legend.background`\n:::\n\n## Theme functions\n\n### Use special functions to manipulate specific elements\n\n::: incremental\n\n- Text-based things = `element_text()`\n- Rectangular things (backgrounds) = `element_rect()`\n- Line-based things (axis lines, grid lines) = `element_line()`\n- Disable element completely = `element_blank()`\n\n:::\n\n## How to learn `theme()`\n\n::: incremental\n\n- The `theme()` function has **94** possible arguments\n- You can get hyper-specific with things like `axis.ticks.length.x.bottom`\n- The only way to learn how to use `theme()` is to use it and tinker with it\n\n:::\n\n## Live coding\n\n```r\n# install if necessary\ninstall.packages(c(\"tidyverse\", \"here\", \"colorspace\",\n                   \"scales\", \"ggrepel\", \"ggtext\", \"usethis\"))\n\nusethis::use_course(\"uc-dataviz/themes-annotations\")\n```\n\nTODO\n\n# Axes\n\n## Axis breaks\n\n::: task\nHow can the following figure be improved with custom breaks in axes, if at all?\n:::\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-10_6601edbfc8f7834fffb51ca03e8746ce'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-10-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n## Context matters\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-11_1a07a6ef14c90e58a2a91eeb5f1b5a1a'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\npac_plot +\n  scale_x_continuous(breaks = seq(from = 2000, to = 2020, by = 2))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n## Conciseness matters\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-12_276cea854d835036729d1a8093c7d8e3'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\npac_plot +\n  scale_x_continuous(breaks = seq(2000, 2020, 4))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n## Precision matters\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-13_41cc307801106836918b9aa6ded0660a'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\npac_plot +\n  scale_x_continuous(breaks = seq(2000, 2020, 4)) +\n  labs(x = \"Election year\")\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n# Fretting the little things\n\n## Little details matter\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-14_4edcca50e9876c81f5fb300fdd647a9a'}\n::: {.cell-output-display}\n![](images/10/stevejobs.jpg){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n::: {.column .fragment width=\"50%\"}\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-15_6639572616daea6a707bad24f6906b9c'}\n::: {.cell-output-display}\n![](images/10/apple_iie.jpg){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n::::\n\n## Obsession with tiny details\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-16_9d2fcdfa7e6cb09c2bf782d35471eabe'}\n::: {.cell-output-display}\n![](images/10/ibm-circuit.jpg){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n::: {.column .fragment width=\"50%\"}\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-17_f47d2402820b517d65ab8e827655206a'}\n::: {.cell-output-display}\n![](images/10/apple-iie-circuit.jpg){fig-align='center' width=80%}\n:::\n:::\n\n:::\n\n::::\n\n## Human-focused design\n\n::: large\n> \"This is what customers pay us for -- to sweat all these details so it's easy and pleasant for them to use our computers.\"\n:::\n\n## Graph details: Redundant coding\n\n\n\n\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-19_9f7830629517905c4d73127580979070'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-19-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column .fragment width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-20_f1b8ad941bce2ceb2a795bb0a337aac5'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-20-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::::\n\n## Graph details: Consistent ordering\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-21_ed19f4fafc45c18cef59431fb9b72e99'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-21-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column .fragment width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-22_e99a41e5276fe7ee5581e18749979e74'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-22-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::::\n\n## Details matter\n\nWorrying about tiny details in graphs...\n\n. . .\n\n...makes them easier for your audience to understand\n\n. . .\n\n...improves their beauty\n\n. . .\n\n...enhances the truth\n\n# Text in plots\n\n## Including text on a plot\n\n### Label actual data points\n\n`geom_text()`, `geom_label()`, `geom_text_repel()`, etc.\n\n. . .\n\n### Add arbitrary annotations\n\n`annotate()`\n\n## Label actual data points\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-text-bad_644bc7727a4ad4ea34874ad0dba21bf3'}\n\n```{.r .cell-code  code-line-numbers=\"14\"}\nlibrary(gapminder)\n\ngapminder_europe <- gapminder |>\n  filter(\n    year == 2007,\n    continent == \"Europe\"\n  )\n\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  geom_text(aes(label = country))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-text-bad-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Label actual data points\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-label-bad_b13a3a191e78eccdd4551558609a5c04'}\n\n```{.r .cell-code  code-line-numbers=\"6\"}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  geom_label(aes(label = country))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-label-bad-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Solution 1: Repel labels\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-repel_3ca8a98492203ec22e7ac83a08474f9c'}\n\n```{.r .cell-code  code-line-numbers=\"1,8\"}\nlibrary(ggrepel)\n\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  geom_text_repel(aes(label = country))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-repel-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Solution 1: Repel labels\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-repel-label_706ce111b93e21d5971ba177f0d38904'}\n\n```{.r .cell-code  code-line-numbers=\"1,8\"}\nlibrary(ggrepel)\n\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  geom_label_repel(aes(label = country)) #<<\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-repel-label-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Solution 2a: Don't use so many labels\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-repel-filtered_bda1d19da3356f2b9a7c5cf32fee891d'}\n\n```{.r .cell-code  code-line-numbers=\"16-19\"}\ngapminder_europe <- gapminder_europe |>\n  mutate(\n    should_be_labeled = country %in% c(\n      \"Albania\",\n      \"Norway\",\n      \"Hungary\"\n    )\n  )\n\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  geom_label_repel(\n    data = filter(\n      gapminder_europe,\n      should_be_labeled == TRUE\n    ),\n    aes(label = country)\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-repel-filtered-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Solution 2b: Use other aesthetics too\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-repel-filtered-fancy_dc1e61c2d65373ecde8a626cbde63b08'}\n\n```{.r .cell-code}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point(aes(color = should_be_labeled)) +\n  geom_label_repel(\n    data = filter(\n      gapminder_europe,\n      should_be_labeled == TRUE\n    ),\n    aes(\n      label = country,\n      fill = should_be_labeled\n    ),\n    color = \"white\"\n  ) +\n  scale_color_manual(values = c(\n    \"grey50\",\n    \"red\"\n  )) +\n  scale_fill_manual(values = c(\"red\")) +\n  guides(color = \"none\", fill = \"none\")\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-repel-filtered-fancy-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## (Highlight non-text things too!)\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-highlight_f8afe617140c71c62d7bcb099c4a3598'}\n\n```{.r .cell-code}\n# Color just Oceania\ngapminder_highlighted <- gapminder |>\n  mutate(\n    is_oceania =\n      ifelse(continent == \"Oceania\",\n        TRUE, FALSE\n      )\n  )\n\nggplot(\n  gapminder_highlighted,\n  aes(\n    x = year, y = lifeExp,\n    group = country,\n    color = is_oceania,\n    size = is_oceania\n  )\n) +\n  geom_line() +\n  scale_color_manual(values = c(\n    \"grey70\",\n    \"red\"\n  )) +\n  scale_size_manual(values = c(0.1, 0.5)) +\n  guides(color = \"none\", size = \"none\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-highlight-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Including text on a plot\n\n### Label actual data points\n\n`geom_text()`, `geom_label()`, `geom_text_repel()`, etc.\n\n. . .\n\n### Add arbitrary annotations\n\n`annotate()`\n\n## Adding arbitrary annotations\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-annotate-1_ac9e688a00f5d7900db3b4a74574ab5c'}\n\n```{.r .cell-code  code-line-numbers=\"6-10\"}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  annotate(\n    geom = \"text\",\n    x = 40000, y = 76,\n    label = \"Some text!\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-annotate-1-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Adding arbitrary annotations\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-annotate-2_21a473a14da58563eafde33c2f8766b6'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  annotate(\n    geom = \"label\",\n    x = 40000, y = 76,\n    label = \"Some text!\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-annotate-2-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Any geom works\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-annotate-3_9b12c7350fee7eb181b259ba1befed82'}\n\n```{.r .cell-code  code-line-numbers=\"6,7,9\"}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  # This is evil though!!!\n  # We just invented a point\n  annotate(\n    geom = \"point\",\n    x = 40000, y = 76\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-annotate-3-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Any geom works\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-annotate-4_0fc2d7c99a9019e3c8745207e1f0ad3e'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  annotate(\n    geom = \"rect\",\n    xmin = 30000, xmax = 50000,\n    ymin = 78, ymax = 82,\n    fill = \"red\", alpha = 0.2\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-annotate-4-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Use multiple annotations\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/gapminder-annotate-5_d9da692f4be130695534936ed2777c58'}\n\n```{.r .cell-code}\nggplot(\n  gapminder_europe,\n  aes(x = gdpPercap, y = lifeExp)\n) +\n  geom_point() +\n  annotate(\n    geom = \"rect\",\n    xmin = 30000, xmax = 50000,\n    ymin = 78, ymax = 82,\n    fill = \"red\", alpha = 0.2\n  ) +\n  annotate(\n    geom = \"label\",\n    x = 40000, y = 76.5,\n    label = \"Rich and long-living\"\n  ) +\n  annotate(\n    geom = \"segment\",\n    x = 40000, xend = 40000,\n    y = 76.8, yend = 77.8,\n    arrow = arrow(\n      length = unit(0.1, \"in\")\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/gapminder-annotate-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n# Complex annotations\n\n## World development indicators\n\n\n\n\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/load-data-wdi-real_b64c12d9c5c0ff949071325dfa8376eb'}\n\n```{.r .cell-code}\nwdi_co2_raw <- read_csv(\"data/wdi_co2.csv\")\n```\n:::\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/clean-data-wdi_8c188233c9e8f17a72380d227a0e4e0a'}\n\n```{.r .cell-code}\nwdi_clean <- wdi_co2_raw |>\n  filter(region != \"Aggregates\") |>\n  select(iso2c, iso3c, country, year,\n    population = SP.POP.TOTL,\n    co2_emissions = EN.ATM.CO2E.PC,\n    gdp_per_cap = NY.GDP.PCAP.KD,\n    region, income\n  )\n\nglimpse(wdi_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 4,536\nColumns: 9\n$ iso2c         <chr> \"AF\", \"AF\", \"AF\", \"AF\", \"AF\", \"AF\", \"AF\", \"AF\", \"AF\", \"A…\n$ iso3c         <chr> \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", …\n$ country       <chr> \"Afghanistan\", \"Afghanistan\", \"Afghanistan\", \"Afghanista…\n$ year          <dbl> 2015, 1997, 2014, 2003, 2000, 2002, 2010, 2011, 2001, 20…\n$ population    <dbl> 33753499, 17788819, 32716210, 22645130, 19542982, 210002…\n$ co2_emissions <dbl> 0.17627802, 0.06183660, 0.14916154, 0.05387472, 0.038888…\n$ gdp_per_cap   <dbl> 592.4765, NA, 602.5170, 363.1015, NA, 359.7663, 569.2827…\n$ region        <chr> \"South Asia\", \"South Asia\", \"South Asia\", \"South Asia\", …\n$ income        <chr> \"Low income\", \"Low income\", \"Low income\", \"Low income\", …\n```\n:::\n:::\n\n\n## Clean and reshape data {.smaller}\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/rearrange-data_2b90aed1133326a4911c1040b12d6c33'}\n\n```{.r .cell-code}\nco2_rankings <- wdi_clean |>\n  # Get rid of smaller countries\n  filter(population > 200000) |>\n  # Only look at two years\n  filter(year %in% c(1995, 2014)) |>\n  # Get rid of all the rows that have missing values in co2_emissions\n  drop_na(co2_emissions) |>\n  # Look at each year individually and rank countries based on their emissions that year\n  group_by(year) |>\n  mutate(ranking = rank(co2_emissions)) |>\n  ungroup() |>\n  # Only select required columns\n  select(iso3c, country, year, region, income, ranking) |>\n  # pivot long\n  pivot_wider(names_from = year, names_prefix = \"rank_\", values_from = ranking) |>\n  # Find the difference in ranking between 2014 and 1995\n  mutate(rank_diff = rank_2014 - rank_1995) |>\n  # Remove all rows where there's a missing value in the rank_diff column\n  drop_na(rank_diff) |>\n  # Make an indicator variable that is true of the absolute value of the\n  # difference in rankings is greater than 25\n  mutate(big_change = ifelse(abs(rank_diff) >= 25, TRUE, FALSE)) |>\n  # Make another indicator variable that indicates if the rank improved by a\n  # lot, worsened by a lot, or didn't change much.\n  mutate(better_big_change = case_when(\n    rank_diff <= -25 ~ \"Rank improved\",\n    rank_diff >= 25 ~ \"Rank worsened\",\n    TRUE ~ \"Rank changed a little\"\n  ))\n```\n:::\n\n\n## Clean and reshape data\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/show-head-original_7cd2add8115116cdd1e9f398b3465703'}\n\n```{.r .cell-code}\nhead(wdi_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  iso2c iso3c country      year population co2_emissions gdp_per…¹ region income\n  <chr> <chr> <chr>       <dbl>      <dbl>         <dbl>     <dbl> <chr>  <chr> \n1 AF    AFG   Afghanistan  2015   33753499        0.176       592. South… Low i…\n2 AF    AFG   Afghanistan  1997   17788819        0.0618       NA  South… Low i…\n3 AF    AFG   Afghanistan  2014   32716210        0.149       603. South… Low i…\n4 AF    AFG   Afghanistan  2003   22645130        0.0539      363. South… Low i…\n5 AF    AFG   Afghanistan  2000   19542982        0.0389       NA  South… Low i…\n6 AF    AFG   Afghanistan  2002   21000256        0.0490      360. South… Low i…\n# … with abbreviated variable name ¹​gdp_per_cap\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/show-head-new_6cc836b49fe83f8e2e7f5c2ced134181'}\n\n```{.r .cell-code}\nhead(co2_rankings)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  iso3c country     region        income rank_…¹ rank_…² rank_…³ big_c…⁴ bette…⁵\n  <chr> <chr>       <chr>         <chr>    <dbl>   <dbl>   <dbl> <lgl>   <chr>  \n1 AFG   Afghanistan South Asia    Low i…      12      15      -3 FALSE   Rank c…\n2 ALB   Albania     Europe & Cen… Upper…      72      51      21 FALSE   Rank c…\n3 DZA   Algeria     Middle East … Lower…     107      94      13 FALSE   Rank c…\n4 AGO   Angola      Sub-Saharan … Lower…      64      64       0 FALSE   Rank c…\n5 ARG   Argentina   Latin Americ… Upper…     113      99      14 FALSE   Rank c…\n6 ARM   Armenia     Europe & Cen… Upper…      79      69      10 FALSE   Rank c…\n# … with abbreviated variable names ¹​rank_2014, ²​rank_1995, ³​rank_diff,\n#   ⁴​big_change, ⁵​better_big_change\n```\n:::\n:::\n\n\n# Plot the data and annotate\n\n## Plot the data and annotate {.smaller}\n\n\n\n\n\n::: task\nSet the random seed for reproducibility.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-0_d5c9528eb13e18d60ec376497aeaf76d'}\n\n```{.r .cell-code  code-line-numbers=\"1\"}\nset.seed(123)\n```\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nInitialize the `ggplot()` object.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-1_352b7c2f6a9fdc4bf8c5fc710a1f9696'}\n\n```{.r .cell-code  code-line-numbers=\"3-6\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n)\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nCreate a basic scatterplot, color-coded based on rank changes.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-2_45f0056951b4db4ea6d146b80546ff91'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  geom_point(aes(color = better_big_change))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nLabel points for countries with a \"big\" change.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-3_cb2e3ef6f76376cc85949e572d73ea3c'}\n\n```{.r .cell-code  code-line-numbers=\"8-12\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nAdd a reference line in the background to show what it would look like if countries did not change rank order. Note `xend` and `yend` differ due to new countries forming during the 20 year period.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-5_895a7a66106f158d1ba8160151167bf6'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nAnnotate the plot to clarify outliers that are improving.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-6_1b82f491d58bab57738a680e34cce350'}\n\n```{.r .cell-code  code-line-numbers=\"14-17\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nAnnotate the plot to clarify the outliers that are worsening.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-7_f61ade9788db0f4bb6a0b808ddb9b36d'}\n\n```{.r .cell-code  code-line-numbers=\"18-21\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nChoose a custom color palette to highlight the outliers.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-8_4a7c3bc8a3bf5efe4a338e9b43180350'}\n\n```{.r .cell-code  code-line-numbers=\"22\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\"))\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nUse the same colors for the labels. Only need the last two values in the original palette.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-9_e9573e259b09c6443e674b884bdba406'}\n\n```{.r .cell-code  code-line-numbers=\"23\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) #<<\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nAdjust the axis labeling and remove the padding on both axes.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-10_2ab131203786d7778f24ca65e556e89a'}\n\n```{.r .cell-code  code-line-numbers=\"24-25\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) + #<<\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) #<<\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nAdd human-readable titles, labels, etc.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-11_a8530dbb1f99ce0d3b2be0115104b3c6'}\n\n```{.r .cell-code  code-line-numbers=\"26-31\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  labs(\n    x = \"Rank in 1995\", y = \"Rank in 2014\",\n    title = \"Changes in CO2 emission rankings between 1995 and 2014\",\n    subtitle = \"Countries that improved or worsened more than 25 positions in the rankings highlighted\",\n    caption = \"Source: The World Bank.\\nCountries with populations of less than 200,000 excluded.\"\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-11-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nGet rid of the legends - unnecessary.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-12_6bb0294d1c1f49ab717fb870c1be5613'}\n\n```{.r .cell-code  code-line-numbers=\"32\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  labs(\n    x = \"Rank in 1995\", y = \"Rank in 2014\",\n    title = \"Changes in CO2 emission rankings between 1995 and 2014\",\n    subtitle = \"Countries that improved or worsened more than 25 positions in the rankings highlighted\",\n    caption = \"Source: The World Bank.\\nCountries with populations of less than 200,000 excluded.\"\n  ) +\n  guides(color = \"none\", fill = \"none\")\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nChange the base theme and font to match the text labels.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-13_62704d7385032c107f96475a061dff3b'}\n\n```{.r .cell-code  code-line-numbers=\"33\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  labs(\n    x = \"Rank in 1995\", y = \"Rank in 2014\",\n    title = \"Changes in CO2 emission rankings between 1995 and 2014\",\n    subtitle = \"Countries that improved or worsened more than 25 positions in the rankings highlighted\",\n    caption = \"Source: The World Bank.\\nCountries with populations of less than 200,000 excluded.\"\n  ) +\n  guides(color = \"none\", fill = \"none\") +\n  theme_bw(base_family = \"Roboto Condensed\")\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nUse HTML and Markdown syntax to customize the visual appearance of the title and subtitle.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-14_5c8f1fff410e1360e8802615e44f8a2c'}\n\n```{.r .cell-code  code-line-numbers=\"28-29\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  labs(\n    x = \"Rank in 1995\", y = \"Rank in 2014\",\n    title = \"Changes in CO<sub>2</sub> emission rankings between 1995 and 2014\", #<<\n    subtitle = \"Countries that <span style='color: #0074D9'>**improved**</span> or <span style='color: #FF4136'>**worsened**</span> more than 25 positions in the rankings highlighted\", #<<\n    caption = \"Source: The World Bank.\\nCountries with populations of less than 200,000 excluded.\"\n  ) +\n  guides(color = \"none\", fill = \"none\") +\n  theme_bw(base_family = \"Roboto Condensed\")\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-14-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Plot the data and annotate {.smaller}\n\n::: task\nEnsure rendering of HTML/Markdown syntax with `ggtext::element_markdown()`.\n:::\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='10-themes-axes-annotation_cache/revealjs/pretty-plot-15_c084b5942cd3005bcf6398219e708f1b'}\n\n```{.r .cell-code  code-line-numbers=\"34-38\"}\nset.seed(123)\n\nggplot(\n  data = co2_rankings,\n  mapping = aes(x = rank_1995, y = rank_2014)\n) +\n  annotate(geom = \"segment\", x = 0, xend = 172, y = 0, yend = 178) +\n  geom_point(aes(color = better_big_change)) +\n  geom_label_repel(\n    data = filter(co2_rankings, big_change == TRUE),\n    aes(label = country, fill = better_big_change),\n    color = \"white\", family = \"Roboto Condensed\"\n  ) +\n  annotate(\n    geom = \"text\", x = 170, y = 6, label = \"Outliers improving\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 1, color = \"grey50\"\n  ) +\n  annotate(\n    geom = \"text\", x = 2, y = 170, label = \"Outliers worsening\",\n    family = \"Roboto Condensed\", fontface = \"italic\", hjust = 0, color = \"grey50\"\n  ) +\n  scale_color_manual(values = c(\"grey50\", \"#0074D9\", \"#FF4136\")) +\n  scale_fill_manual(values = c(\"#0074D9\", \"#FF4136\")) +\n  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 175, 25)) +\n  labs(\n    x = \"Rank in 1995\", y = \"Rank in 2014\",\n    title = \"Changes in CO<sub>2</sub> emission rankings between 1995 and 2014\",\n    subtitle = \"Countries that <span style='color: #0074D9'>**improved**</span> or <span style='color: #FF4136'>**worsened**</span> more than 25 positions in the rankings highlighted\",\n    caption = \"Source: The World Bank.\\nCountries with populations of less than 200,000 excluded.\"\n  ) +\n  guides(color = \"none\", fill = \"none\") +\n  theme_bw(base_family = \"Roboto Condensed\") +\n  theme(\n    plot.title = element_markdown(face = \"bold\", size = rel(1.6)),\n    plot.subtitle = element_markdown(size = rel(1.3)),\n    plot.margin = unit(c(0.5, 1, 0.5, 0.5), units = \"lines\")\n  )\n```\n\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/pretty-plot-15-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Final plot\n\n\n::: {.cell layout-align=\"center\" hash='10-themes-axes-annotation_cache/revealjs/unnamed-chunk-58_e9f7c31a40054f778ee5b3af50a6c655'}\n::: {.cell-output-display}\n![](10-themes-axes-annotation_files/figure-revealjs/unnamed-chunk-58-1.png){fig-align='center' width=90%}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}