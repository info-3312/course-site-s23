{
  "hash": "9ec794e16042e8ccbf10dada6efd7fdf",
  "result": {
    "markdown": "---\ntitle: \"The grammar of graphics\"\nsubtitle: \"Lecture 2\"\ndate: \"January 26, 2023\"\nformat: revealjs\n---\n\n\n\n\n# Data visualization\n\n## Data visualization\n\n> *\"The simple graph has brought more information to the data analyst's mind than any other device.\"*\n> \n> John Tukey\n\n- Data visualization is the creation and study of the visual representation of data\n- Many tools for visualizing data -- R is one of them\n- Many approaches/systems within R for making data visualizations -- **ggplot2** is one of them, and that's what we're going to use\n\n## ggplot2 $\\in$ tidyverse\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-2_6ceca027b524a19cafa6c6a23e48c47d'}\n::: {.cell-output-display}\n![](images/02/ggplot2-part-of-tidyverse.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n- **ggplot2** is tidyverse's data visualization package \n- `gg` in \"ggplot2\" stands for Grammar of Graphics \n- Inspired by the book **Grammar of Graphics** by Leland Wilkinson\n\n:::\n::::\n\n## Grammar of Graphics\n\n:::: columns\n\n::: {.column width=\"33%\"}\n\nA grammar of graphics is a tool that enables us to concisely describe the components of a graphic\n\n:::\n\n::: {.column width=\"67%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-3_23d2c7ab4296892a753a21e31cf0cecd'}\n::: {.cell-output-display}\n![](images/02/grammar-of-graphics.png){fig-align='center' width=90%}\n:::\n:::\n\n\n:::\n::::\n\n::: aside\nSource: [BloggoType](http://bloggotype.blogspot.com/2016/08/holiday-notes2-grammar-of-graphics.html)\n:::\n\n## Hello ggplot2!\n\n- `ggplot()` is the main function in ggplot2\n- Plots are constructed in layers\n- Structure of the code for plots can be summarized as\n\n```r\nggplot(data = [dataset], \n       mapping = aes(x = [x-variable], y = [y-variable])) +\n   geom_xxx() +\n   other options\n```\n\n- The ggplot2 package comes with the tidyverse\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-4_d4987b12a3bd0a01db42b0f1a31c8dbc'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n- For help with ggplot2, see [ggplot2.tidyverse.org](http://ggplot2.tidyverse.org/)\n\n# Why do we visualize?\n\n## Why do we visualize? \n\n1. Discover patterns that may not be obvious from numerical summaries\n\n## Anscombe's quartet\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/quartet-for-show_f8acf2d84ce34201d15dc991a9fd8395'}\n\n```{.r .cell-code}\nlibrary(Tmisc)\nquartet |> slice_head(n = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   set  x     y\n1    I 10  8.04\n2    I  8  6.95\n3    I 13  7.58\n4    I  9  8.81\n5    I 11  8.33\n6    I 14  9.96\n7    I  6  7.24\n8    I  4  4.26\n9    I 12 10.84\n10   I  7  4.82\n11   I  5  5.68\n12  II 10  9.14\n13  II  8  8.14\n14  II 13  8.74\n15  II  9  8.77\n```\n:::\n:::\n\n\n## Summary statistics for Anscombe's quartet\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/quartet-summary_c39f801a2d5b5f4f793a9d6292c14391'}\n\n```{.r .cell-code}\nquartet |>\n  group_by(set) |>\n  summarise(\n    mean_x = mean(x), \n    mean_y = mean(y),\n    sd_x = sd(x),\n    sd_y = sd(y),\n    r = cor(x, y)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 √ó 6\n  set   mean_x mean_y  sd_x  sd_y     r\n  <fct>  <dbl>  <dbl> <dbl> <dbl> <dbl>\n1 I          9   7.50  3.32  2.03 0.816\n2 II         9   7.50  3.32  2.03 0.816\n3 III        9   7.5   3.32  2.03 0.816\n4 IV         9   7.50  3.32  2.03 0.817\n```\n:::\n:::\n\n\n## Scatterplots for Anscombe's quartet\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/quartet-plot_b4ba77f0b337b14733005737651358e2'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/quartet-plot-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Why do we visualize? \n\n1. Discover patterns that may not be obvious from numerical summaries\n\n2. Convey information in a way that is otherwise difficult/impossible to convey\n\n## [Impact of Omicron variant on unvaccinated populations]{.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-8_501de3eda39b639104d3b5fd5a3046da'}\n::: {.cell-output-display}\n![](images/02/covid-hong-kong.jpeg){fig-align='center' width=70%}\n:::\n:::\n\n\n::: aside\nSource: [John Burn-Murdoch](https://twitter.com/jburnmurdoch/status/1503420660869214213)\n:::\n\n## [COVID-19 vaccination in US Counties]{.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-9_064b676f5a9efa0269aee6fc6065ca1c'}\n::: {.cell-output-display}\n![](images/02/nytimes-us-covid-vaccine.png){fig-align='center' width=70%}\n:::\n:::\n\n\n::: aside\nSource: [New York Times](https://www.nytimes.com/interactive/2020/us/covid-19-vaccine-doses.html), March 28, 2022.\n:::\n\n# ggplot2 ‚ù§Ô∏è üêß\n\n## ggplot2 $\\in$ tidyverse {.smaller}\n\n:::: columns\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-10_7cd06b8514d5c80c640e7df29c72bfd6'}\n::: {.cell-output-display}\n![](images/02/ggplot2-part-of-tidyverse.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n- **ggplot2** is tidyverse's data visualization package \n- Structure of the code for plots can be summarized as\n\n```r\nggplot(data = [dataset], \n       mapping = aes(x = [x-variable], \n                     y = [y-variable])) +\n   geom_xxx() +\n   other options\n```\n\n:::\n::::\n\n## Data: Palmer Penguins\n\nMeasurements for penguin species, island in Palmer Archipelago, size (flipper length, body mass, bill dimensions), and sex.\n\n:::: columns\n\n::: {.column width=\"33%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-11_d5f139b1d91a0955870ab16c52945fc8'}\n::: {.cell-output-display}\n![](images/02/penguins.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n::: {.column width=\"67%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-12_4166c6799e9226c901ee1c270e2562fc'}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nglimpse(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Ad‚Ä¶\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen‚Ä¶\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39‚Ä¶\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19‚Ä¶\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193‚Ä¶\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 46‚Ä¶\n$ sex               <fct> male, female, female, NA, female, male, fe‚Ä¶\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, ‚Ä¶\n```\n:::\n:::\n\n\n:::\n::::\n\n---\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-13_50ca01dab58999753f757bb82b50af27'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/penguins_4ddb72fae6c7f1925d74d52004790d66'}\n\n```{.r .cell-code}\nggplot(data = penguins, \n       mapping = aes(x = bill_depth_mm, y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       color = \"Species\")\n```\n:::\n\n\n:::\n\n# Coding out loud\n\n---\n\n::: {.small}\n> **Start with the `penguins` data frame**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-0_134732e10da2cd15c3659aa9946be522'}\n\n```{.r .cell-code  code-line-numbers=\"1\"}\nggplot(data = penguins)\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-0-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> **map bill depth to the x-axis**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-1_ed52a1578303cb856458307236eced9c'}\n\n```{.r .cell-code  code-line-numbers=\"2\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> **and map bill length to the y-axis.**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-2_85cdecc1bbbc0288f1988e236ea2d6be'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> **Represent each observation with a point**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-3_1efd2e2c1fb08af282c3a79da54cf44c'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> **and map species to the color of each point.**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-4_efe30e4c1e40cd89f7f843256c41d8cb'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> **Title the plot \"Bill depth and length\"**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-5_ce2dc287ff220c939cc331ec3fcff772'}\n\n```{.r .cell-code  code-line-numbers=\"6\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> Title the plot \"Bill depth and length\", \n> **add the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\"**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-6_5ca247816c118042d045138809a236aa'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-6-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> Title the plot \"Bill depth and length\", \n> add the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\", \n> **label the x and y axes as \"Bill depth (mm)\" and \"Bill length (mm)\", respectively**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-7_703ef26305215524c888421a8a84e6d8'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> Title the plot \"Bill depth and length\", \n> add the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\", \n> label the x and y axes as \"Bill depth (mm)\" and \"Bill length (mm)\", respectively,\n> **label the legend \"Species\"**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-8_722e78f974aaf226fa50d627bfd79ab2'}\n\n```{.r .cell-code  code-line-numbers=\"9\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       color = \"Species\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> Title the plot \"Bill depth and length\", \n> add the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\", \n> label the x and y axes as \"Bill depth (mm)\" and \"Bill length (mm)\", respectively,\n> label the legend \"Species\", \n> **and add a caption for the data source.**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-9_e957565c87d3c45d0c7271cf57043b4a'}\n\n```{.r .cell-code  code-line-numbers=\"10\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       color = \"Species\",\n       caption = \"Source: Palmer Station LTER / palmerpenguins package\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n> Start with the `penguins` data frame,\n> map bill depth to the x-axis\n> and map bill length to the y-axis. \n> Represent each observation with a point\n> and map species to the color of each point.\n> Title the plot \"Bill depth and length\", \n> add the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\", \n> label the x and y axes as \"Bill depth (mm)\" and \"Bill length (mm)\", respectively,\n> label the legend \"Species\", \n> and add a caption for the data source.\n> **Finally, use a discrete color scale that is designed to be perceived by viewers with common forms of color blindness.**\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/penguins-10_687f6cbfc13e4534f26783570d1e842b'}\n\n```{.r .cell-code  code-line-numbers=\"11\"}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       color = \"Species\",\n       caption = \"Source: Palmer Station LTER / palmerpenguins package\") +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/penguins-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-26_780f448a892b5c79b2ff4246aa32aca3'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-26-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/penguins-10-nohighlight_3d0267623fef3a22e110c15069495412'}\n\n```{.r .cell-code}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  labs(title = \"Bill depth and length\",\n       subtitle = \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\",\n       x = \"Bill depth (mm)\", y = \"Bill length (mm)\",\n       color = \"Species\",\n       caption = \"Source: Palmer Station LTER / palmerpenguins package\") +\n  scale_color_viridis_d()\n```\n:::\n\n\n### Narrative\n\nStart with the `penguins` data frame,\nmap bill depth to the x-axis\nand map bill length to the y-axis. \n\nRepresent each observation with a point\nand map species to the color of each point.\n\nTitle the plot \"Bill depth and length\", \nadd the subtitle \"Dimensions for Adelie, Chinstrap, and Gentoo Penguins\", \nlabel the x and y axes as \"Bill depth (mm)\" and \"Bill length (mm)\", respectively,\nlabel the legend \"Species\", \nand add a caption for the data source.\n\nFinally, use a discrete color scale that is designed to be perceived by viewers with common forms of color blindness.\n\n:::\n\n---\n\n## Argument names\n\n::: appex\nYou can omit the names of first two arguments when building plots with `ggplot()`.\n:::\n\n:::: columns\n\n::: {.column .small width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/named-args_f0088d3c930abc2564511b68b1ed5304'}\n\n```{.r .cell-code}\nggplot(data = penguins,\n       mapping = aes(x = bill_depth_mm,\n                     y = bill_length_mm,\n                     color = species)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n:::\n\n\n:::\n\n::: {.column .small width=\"50%\"}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/not-named-args_19363c66261d0d1dc42df2f41ab5d02e'}\n\n```{.r .cell-code}\nggplot(penguins,\n       aes(x = bill_depth_mm,\n           y = bill_length_mm,\n           color = species)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n:::\n\n\n:::\n\n::::\n\n# Aesthetics\n\n\n## Aesthetics options\n\nCommonly used characteristics of plotting characters that can be **mapped to a specific variable** in the data are\n\n- `color`\n- `shape`\n- `size`\n- `alpha` (transparency)\n\n## Color\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/color_3cc32bb2e3e0a695b60628cd0253c4d4'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nggplot(penguins,\n       aes(x = bill_depth_mm, \n           y = bill_length_mm,\n           color = species)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/color-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Shape\n\nMapped to a different variable than `color`\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/shape-island_0c2898942fe716bd31c45f6600973ea7'}\n\n```{.r .cell-code  code-line-numbers=\"5\"}\nggplot(penguins,\n       aes(x = bill_depth_mm, \n           y = bill_length_mm,\n           color = species,\n           shape = island)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/shape-island-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Shape\n\nMapped to same variable as `color`\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/shape-species_cab221ff073be962e1a83f95253b40f9'}\n\n```{.r .cell-code  code-line-numbers=\"5\"}\nggplot(penguins,\n       aes(x = bill_depth_mm, \n           y = bill_length_mm,\n           color = species,\n           shape = species)) + #<<\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/shape-species-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Size\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/size_07dac909fe54d969aebb00998108e2e6'}\n\n```{.r .cell-code  code-line-numbers=\"6\"}\nggplot(penguins,\n       aes(x = bill_depth_mm, \n           y = bill_length_mm,\n           color = species,\n           shape = species,\n           size = body_mass_g)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/size-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Alpha\n\n\n::: {.cell layout-align=\"center\" output-location='column' hash='02-grammar-of-graphics_cache/revealjs/alpha_6513a91f7a77e83d0a8331870dd06d31'}\n\n```{.r .cell-code  code-line-numbers=\"7\"}\nggplot(penguins,\n       aes(x = bill_depth_mm, \n           y = bill_length_mm,\n           color = species,\n           shape = species,\n           size = body_mass_g,\n           alpha = flipper_length_mm)) +\n  geom_point() +\n  scale_color_viridis_d()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/alpha-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n---\n\n:::: columns\n\n::: {.column .small width=\"50%\"}\n\n### Mapping\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-35_bfdb0e90182932cae64d2ee2dcabc517'}\n\n```{.r .cell-code  code-line-numbers=\"4,5\"}\nggplot(penguins,\n       aes(x = bill_depth_mm,\n           y = bill_length_mm,\n           size = body_mass_g,\n           alpha = flipper_length_mm)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-35-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column .small width=\"50%\"}\n\n### Setting\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-36_939e0283bc955431ee3e07225cea7590'}\n\n```{.r .cell-code  code-line-numbers=\"4\"}\nggplot(penguins,\n       aes(x = bill_depth_mm,\n           y = bill_length_mm)) + \n  geom_point(size = 2, alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-36-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::::\n\n## Mapping vs. setting\n\n- **Mapping:** Determine the size, alpha, etc. of points based on the values of a variable in the data\n  - goes into `aes()`\n\n- **Setting:** Determine the size, alpha, etc. of points **not** based on the values of a variable in the data\n  - goes into `geom_*()` (this was `geom_point()` in the previous example, but we'll learn about other geoms soon!)\n  \n# Faceting\n\n## Faceting\n\n- Smaller plots that display different subsets of the data\n- Useful for exploring conditional relationships and large data\n\n---\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-37_c33f3057157a9c59d55efd16a5c5ad58'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-37-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/facet_4048a16e6826e552216ee7fcd0cba5e4'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_grid(rows = vars(species), cols = vars(island))\n```\n:::\n\n\n:::\n\n## Various ways to facet\n\n::: appex\nIn the next few slides describe what each plot displays. Think about how the code relates to the output.\n\n**Note:** The plots in the next few slides do not have proper titles, axis labels, etc. because we want you to figure out what's happening in the plots. But you should always label your plots!\n:::\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-39_24e6f16ae9dbb5bf6cd8ce894b1b4e40'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_grid(rows = vars(species), cols = vars(sex))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-39-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-40_a5dac9f558a98655342794b3345f5dca'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_grid(rows = vars(sex), cols = vars(species))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-40-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-41_71752c65358889e7a6d3fba0e586cccd'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_wrap(facets = vars(species))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-41-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-42_23a8620673c18f625da348eab436e8e7'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_grid(rows = NULL, cols = vars(species))\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-42-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-43_4f3696f9bac7dbc41f4bd2891385a646'}\n\n```{.r .cell-code  code-line-numbers=\"3\"}\nggplot(penguins, aes(x = bill_depth_mm, y = bill_length_mm)) + \n  geom_point() +\n  facet_wrap(facets = vars(species), ncol = 2)\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-43-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Faceting summary\n\n- `facet_grid()`:\n    - 2 dimensional grid\n    - `rows = vars(<VARIABLE>), cols = vars(<VARIABLE>)`\n    - Alternative: `rows ~ cols`\n- `facet_wrap()`: 1 dimensional ribbon wrapped according to number of rows and columns specified or available plotting area\n\n## Facet and color\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-44_8abdc9d5b36f26943708461221129ca1'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-44-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/facet-color-legend_927a1d114d33f6c8e91ef9568581f00a'}\n\n```{.r .cell-code  code-line-numbers=\"5,8\"}\nggplot(\n  penguins, \n  aes(x = bill_depth_mm, \n      y = bill_length_mm, \n      color = species)) +\n  geom_point() +\n  facet_grid(species ~ sex) +\n  scale_color_viridis_d()\n```\n:::\n\n\n:::\n\n## Facet and color, no legend\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-46_c941a24dcccf021c05b3f074456abb42'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-46-1.png){fig-align='center' width=70%}\n:::\n:::\n\n\n### Code\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/facet-color-no-legend_3843a88c3ec011b7880f8dc7f5ae1a28'}\n\n```{.r .cell-code  code-line-numbers=\"8\"}\nggplot(\n  penguins, \n  aes(x = bill_depth_mm, \n      y = bill_length_mm, \n      color = species)) +\n  geom_point() +\n  facet_grid(species ~ sex) +\n  scale_color_viridis_d(guide = \"none\")\n```\n:::\n\n\n:::\n\n# Take a sad plot, and make it better\n\n---\n\n::: {.appex .small}\nThe American Association of \nUniversity Professors (AAUP) is a nonprofit membership association of faculty \nand other academic professionals. \n[This report](https://www.aaup.org/sites/default/files/files/AAUP_Report_InstrStaff-75-11_apr2013.pdf) \nby the AAUP shows trends in instructional staff employees between 1975 \nand 2011, and contains an image very similar to the one given below.\n:::\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-48_30967a839649f7cf3531c75b2acada10'}\n::: {.cell-output-display}\n![](images/02/staff-employment.png){fig-align='center' width=80%}\n:::\n:::\n\n\n---\n\n::: small\nEach row in this dataset represents a faculty type, and the columns are the years for which we have data. \nThe values are percentage of hires of that type of faculty for each year.\n\n:::\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/load-data-staff_bc71d60c89e7f0603fe382a14788b145'}\n\n```{.r .cell-code}\nstaff <- read_csv(\"data/instructional-staff.csv\")\nstaff\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 √ó 12\n  faculty_type `1975` `1989` `1993` `1995` `1999` `2001` `2003` `2005`\n  <chr>         <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1 Full-Time T‚Ä¶   29     27.6   25     24.8   21.8   20.3   19.3   17.8\n2 Full-Time T‚Ä¶   16.1   11.4   10.2    9.6    8.9    9.2    8.8    8.2\n3 Full-Time N‚Ä¶   10.3   14.1   13.6   13.6   15.2   15.5   15     14.8\n4 Part-Time F‚Ä¶   24     30.4   33.1   33.2   35.5   36     37     39.3\n5 Graduate St‚Ä¶   20.5   16.5   18.1   18.8   18.7   19     20     19.9\n# ‚Ä¶ with 3 more variables: `2007` <dbl>, `2009` <dbl>, `2011` <dbl>\n```\n:::\n:::\n\n\n## Recreate the visualization\n\nIn order to recreate this visualization we need to first reshape the data to have one variable for faculty type and one variable for year. In other words, we will convert the data from the long format to wide format. \n\nBut before we do so... \n\n::: appex\nIf the long data will have a row for each year/faculty type combination, and there are 5 faculty types and 11 years of data, how many rows will the data have?\n:::\n\n---\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-50_40dbfa2a53ccd59e48e7d2b3b8c72454'}\n::: {.cell-output-display}\n![](images/02/pivot.gif){fig-align='center' width=80%}\n:::\n:::\n\n\n## `pivot_*()` function\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-51_be9cb335e0368cfbe9dcc10eca540afe'}\n::: {.cell-output-display}\n![](https://raw.githubusercontent.com/gadenbuie/tidyexplain/main/images/tidyr-pivoting.gif){fig-align='center' width=50%}\n:::\n:::\n\n\n## `pivot_longer()` {.smaller}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-52_59ea14f419ba7b4eb1448421ebd2b266'}\n\n```{.r .cell-code}\npivot_longer(data, cols, names_to = \"name\", values_to = \"value\")\n```\n:::\n\n\n- The first argument is `data` as usual.\n- The second argument, `cols`, is where you specify which columns to pivot \ninto longer format -- in this case all columns except for the `faculty_type` \n- The third argument, `names_to`, is a string specifying the name of the column to create from the data stored in the column names of data -- in this case `year`\n- The fourth argument, `values_to`, is a string specifying the name of the column to create from the data stored in cell values, in this case `percentage`\n\n## Pivot instructor data {.smaller}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-53_fa05ffe27ae9378c229b0e8effc1827f'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nstaff_long <- staff |>\n  pivot_longer(cols = -faculty_type, names_to = \"year\", \n               values_to = \"percentage\") |>\n  mutate(percentage = as.numeric(percentage))\n\nstaff_long\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 55 √ó 3\n   faculty_type              year  percentage\n   <chr>                     <chr>      <dbl>\n 1 Full-Time Tenured Faculty 1975        29  \n 2 Full-Time Tenured Faculty 1989        27.6\n 3 Full-Time Tenured Faculty 1993        25  \n 4 Full-Time Tenured Faculty 1995        24.8\n 5 Full-Time Tenured Faculty 1999        21.8\n 6 Full-Time Tenured Faculty 2001        20.3\n 7 Full-Time Tenured Faculty 2003        19.3\n 8 Full-Time Tenured Faculty 2005        17.8\n 9 Full-Time Tenured Faculty 2007        17.2\n10 Full-Time Tenured Faculty 2009        16.8\n# ‚Ä¶ with 45 more rows\n```\n:::\n:::\n\n\n---\n\n::: {.appex .small}\nThis doesn't look quite right, how would you fix it?\n:::\n\n::: {.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-54_537bc64a4bf0ff961072b607707d48dc'}\n\n```{.r .cell-code}\nstaff_long |>\n  ggplot(aes(x = percentage, y = year, color = faculty_type)) +\n  geom_col(position = \"dodge\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-54-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n---\n\n::: {.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-55_9a7337a2eb82eef0333a76375baeaa39'}\n\n```{.r .cell-code}\nstaff_long |>\n  ggplot(aes(x = percentage, y = year, fill = faculty_type)) +\n  geom_col(position = \"dodge\")\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-55-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n## Some improvement...\n\n::: {.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-56_5fb84f07234312500d61862446813067'}\n\n```{.r .cell-code}\nstaff_long |>\n  ggplot(aes(x = percentage, y = year, fill = faculty_type)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-56-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n:::\n\n## More improvement\n\n::: {.small}\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-57_e19df8c0237114bfe32c802fafb9763f'}\n\n```{.r .cell-code}\nstaff_long |>\n  ggplot(aes(x = year, y = percentage, group = faculty_type, \n             color = faculty_type)) +\n  geom_line() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-57-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n\n## Goal: even more improvement!\n\n::: appex\nI want to achieve the following look but I have no idea how!\n:::\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/instructor-lines-for-show_7352e96088b46a37a7f07b78164fedbc'}\n::: {.cell-output-display}\n![](images/02/sketch.png){fig-align='center' width=60%}\n:::\n:::\n\n\n## Asking good questions\n\n- Describe what you want\n- Describe where you are\n- Create a minimal **repr**oducible **ex**ample: `reprex::reprex()`\n\n---\n\n::: {.panel-tabset}\n\n### Plot\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/unnamed-chunk-59_4c1d88195c972b1c1001851707e2020f'}\n::: {.cell-output-display}\n![](02-grammar-of-graphics_files/figure-revealjs/unnamed-chunk-59-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Code\n\n::: small\n\n\n::: {.cell layout-align=\"center\" hash='02-grammar-of-graphics_cache/revealjs/instructor-lines_31743d4252026c9fd8dcd4ac1efa79e1'}\n\n```{.r .cell-code  code-line-numbers=\"4-8,12-13,19\"}\nlibrary(scales)\n\nstaff_long |>\n  mutate(\n    part_time = if_else(faculty_type == \"Part-Time Faculty\",\n                        \"Part-Time Faculty\", \"Other Faculty\"),\n    year = as.numeric(year)\n    ) |>\n  ggplot(aes(x = year, y = percentage/100, group = faculty_type, \n             color = part_time)) +\n  geom_line() +\n  scale_color_manual(values = c(\"gray\", \"red\")) +\n  scale_y_continuous(labels = label_percent(accuracy = 1)) +\n  theme_minimal() +\n  labs(\n    title = \"Instructional staff employment trends\",\n    x = \"Year\", y = \"Percentage\", color = NULL\n  ) +\n  theme(legend.position = \"bottom\")\n```\n:::\n\n\n:::\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}